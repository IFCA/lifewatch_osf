
{% extends "page.html" %}
{%- from "analyze/modals.html" import terminate_modal, connector_modal with context %}


{% block javascript %}
{{ super() }}
<script type="text/javascript">
  require(
    [
      "jquery",
      "js/analyze/terminator",
      "js/analyze/connector"
    ],
    function($, terminator, connector) {
        terminator.attachTo(".vm-terminator")
        connector.attachTo(".vm-connector")
    });
</script>
{% endblock %}

{% block body %}
<div class="row">
  <div class="col-md-10">
  <div class="panel-list-wrapper">
  <div class="panel panel-deposit panel-sharp">
  <div class="panel-heading">
    <h3>Your instances</h3>
  </div> 
    <table class="table table-stripped">
      <thead>
        <tr>
          <th>Instance Name</th>
          <th>OS</th>
          <th>Size</th>
          <th>Status</th>
          <th>Created</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
    {% if vms %}
      {% for vm in vms %}
        <tr>
          <td>{{ vm.name }}</td>
          <td>{{ vm.image }}</td>
          <td>{{ vm.size }}</td>
          <td>{{ vm.status }}</td>
          <td>{{ vm.created }}</td>
          <td class="text-right">
            <a class="btn btn-sm btn-primary vm-connector" data-vm-status="{{ vm.status.lower() }}"
               data-connect-url="{{ url_for('.connect', vm_id=vm.id) }}" href="#">
                <i class="fa fa-external-link" ></i> Connect
            </a>
            <a class="btn btn-sm btn-warning vm-terminator" data-vm-name="{{ vm.name }}" 
               data-terminate-url="{{ url_for('.terminate', vm_id=vm.id) }}" href="#">
                <i class="fa fa-power-off"></i> Terminate
            </a>
          </td>
        </tr>
      {% endfor %}
        
    {% else %} 
       <tr> 
        <td colspan=7 class="text-center">
            <h2>You have no analysis instances!</h2>
            <h3>Go and run some</h3>
        </td>
       </tr>
    {% endif %}
      </tbody>
    </table>
  </div> 
  </div> 
  </div> 

  <div class="col-md-2">
    <a href="{{ url_for('.launch') }}" class="btn btn-primary btn-raised">Run an analysis</a>
  </div> 
</div>

{{ terminate_modal() }}
{{ connector_modal() }}

{% endblock body %}
